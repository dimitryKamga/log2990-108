"use strict";function cov_ej77p9x2a(){var path="C:\\Users\\USER\\Documents\\GitHub\\log2990-108\\server\\app\\services\\database.service.ts";var hash="b1e971694f35dd3462dd210f76fd6fa6c6085aef";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\USER\\Documents\\GitHub\\log2990-108\\server\\app\\services\\database.service.ts",statementMap:{"0":{start:{line:2,column:17},end:{line:7,column:1}},"1":{start:{line:3,column:12},end:{line:3,column:28}},"2":{start:{line:3,column:34},end:{line:3,column:125}},"3":{start:{line:4,column:4},end:{line:5,column:150}},"4":{start:{line:4,column:79},end:{line:4,column:131}},"5":{start:{line:5,column:9},end:{line:5,column:150}},"6":{start:{line:5,column:22},end:{line:5,column:43}},"7":{start:{line:5,column:58},end:{line:5,column:150}},"8":{start:{line:5,column:81},end:{line:5,column:150}},"9":{start:{line:6,column:4},end:{line:6,column:66}},"10":{start:{line:8,column:16},end:{line:16,column:1}},"11":{start:{line:9,column:28},end:{line:9,column:110}},"12":{start:{line:9,column:91},end:{line:9,column:106}},"13":{start:{line:10,column:4},end:{line:15,column:7}},"14":{start:{line:11,column:36},end:{line:11,column:97}},"15":{start:{line:11,column:42},end:{line:11,column:70}},"16":{start:{line:11,column:85},end:{line:11,column:95}},"17":{start:{line:12,column:35},end:{line:12,column:100}},"18":{start:{line:12,column:41},end:{line:12,column:73}},"19":{start:{line:12,column:88},end:{line:12,column:98}},"20":{start:{line:13,column:32},end:{line:13,column:116}},"21":{start:{line:14,column:8},end:{line:14,column:78}},"22":{start:{line:17,column:0},end:{line:17,column:62}},"23":{start:{line:18,column:0},end:{line:18,column:33}},"24":{start:{line:19,column:20},end:{line:19,column:45}},"25":{start:{line:20,column:11},end:{line:20,column:24}},"26":{start:{line:21,column:20},end:{line:21,column:40}},"27":{start:{line:22,column:18},end:{line:22,column:36}},"28":{start:{line:23,column:15},end:{line:23,column:32}},"29":{start:{line:24,column:0},end:{line:24,column:28}},"30":{start:{line:25,column:22},end:{line:123,column:1}},"31":{start:{line:27,column:8},end:{line:30,column:10}},"32":{start:{line:33,column:8},end:{line:33,column:153}},"33":{start:{line:34,column:8},end:{line:41,column:11}},"34":{start:{line:36,column:12},end:{line:36,column:33}},"35":{start:{line:37,column:12},end:{line:37,column:111}},"36":{start:{line:40,column:12},end:{line:40,column:64}},"37":{start:{line:44,column:8},end:{line:44,column:56}},"38":{start:{line:45,column:8},end:{line:45,column:33}},"39":{start:{line:48,column:8},end:{line:60,column:11}},"40":{start:{line:49,column:12},end:{line:59,column:13}},"41":{start:{line:50,column:16},end:{line:50,column:58}},"42":{start:{line:53,column:16},end:{line:58,column:17}},"43":{start:{line:54,column:20},end:{line:54,column:79}},"44":{start:{line:57,column:20},end:{line:57,column:63}},"45":{start:{line:63,column:8},end:{line:77,column:11}},"46":{start:{line:64,column:12},end:{line:64,column:73}},"47":{start:{line:65,column:30},end:{line:65,column:32}},"48":{start:{line:66,column:12},end:{line:76,column:15}},"49":{start:{line:70,column:16},end:{line:74,column:17}},"50":{start:{line:71,column:20},end:{line:73,column:21}},"51":{start:{line:72,column:24},end:{line:72,column:45}},"52":{start:{line:75,column:16},end:{line:75,column:33}},"53":{start:{line:80,column:8},end:{line:93,column:11}},"54":{start:{line:81,column:12},end:{line:81,column:73}},"55":{start:{line:82,column:12},end:{line:92,column:49}},"56":{start:{line:83,column:16},end:{line:83,column:82}},"57":{start:{line:84,column:16},end:{line:89,column:17}},"58":{start:{line:85,column:20},end:{line:85,column:73}},"59":{start:{line:88,column:20},end:{line:88,column:63}},"60":{start:{line:92,column:16},end:{line:92,column:49}},"61":{start:{line:96,column:8},end:{line:102,column:11}},"62":{start:{line:97,column:12},end:{line:97,column:73}},"63":{start:{line:98,column:12},end:{line:101,column:49}},"64":{start:{line:101,column:16},end:{line:101,column:49}},"65":{start:{line:105,column:8},end:{line:105,column:50}},"66":{start:{line:108,column:27},end:{line:108,column:31}},"67":{start:{line:109,column:21},end:{line:109,column:22}},"68":{start:{line:110,column:8},end:{line:115,column:11}},"69":{start:{line:111,column:12},end:{line:113,column:13}},"70":{start:{line:112,column:16},end:{line:112,column:37}},"71":{start:{line:114,column:12},end:{line:114,column:21}},"72":{start:{line:116,column:8},end:{line:116,column:62}},"73":{start:{line:119,column:35},end:{line:119,column:64}},"74":{start:{line:120,column:36},end:{line:120,column:65}},"75":{start:{line:121,column:8},end:{line:121,column:57}},"76":{start:{line:124,column:0},end:{line:126,column:20}},"77":{start:{line:127,column:0},end:{line:127,column:42}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:46},end:{line:2,column:47}},loc:{start:{line:2,column:87},end:{line:7,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:44},end:{line:8,column:45}},loc:{start:{line:8,column:89},end:{line:16,column:1}},line:8},"2":{name:"adopt",decl:{start:{line:9,column:13},end:{line:9,column:18}},loc:{start:{line:9,column:26},end:{line:9,column:112}},line:9},"3":{name:"(anonymous_3)",decl:{start:{line:9,column:70},end:{line:9,column:71}},loc:{start:{line:9,column:89},end:{line:9,column:108}},line:9},"4":{name:"(anonymous_4)",decl:{start:{line:10,column:36},end:{line:10,column:37}},loc:{start:{line:10,column:63},end:{line:15,column:5}},line:10},"5":{name:"fulfilled",decl:{start:{line:11,column:17},end:{line:11,column:26}},loc:{start:{line:11,column:34},end:{line:11,column:99}},line:11},"6":{name:"rejected",decl:{start:{line:12,column:17},end:{line:12,column:25}},loc:{start:{line:12,column:33},end:{line:12,column:102}},line:12},"7":{name:"step",decl:{start:{line:13,column:17},end:{line:13,column:21}},loc:{start:{line:13,column:30},end:{line:13,column:118}},line:13},"8":{name:"(anonymous_8)",decl:{start:{line:26,column:4},end:{line:26,column:5}},loc:{start:{line:26,column:18},end:{line:31,column:5}},line:26},"9":{name:"(anonymous_9)",decl:{start:{line:32,column:4},end:{line:32,column:5}},loc:{start:{line:32,column:42},end:{line:42,column:5}},line:32},"10":{name:"(anonymous_10)",decl:{start:{line:35,column:18},end:{line:35,column:19}},loc:{start:{line:35,column:30},end:{line:38,column:9}},line:35},"11":{name:"(anonymous_11)",decl:{start:{line:39,column:19},end:{line:39,column:20}},loc:{start:{line:39,column:30},end:{line:41,column:9}},line:39},"12":{name:"(anonymous_12)",decl:{start:{line:43,column:4},end:{line:43,column:5}},loc:{start:{line:43,column:34},end:{line:46,column:5}},line:43},"13":{name:"(anonymous_13)",decl:{start:{line:47,column:4},end:{line:47,column:5}},loc:{start:{line:47,column:26},end:{line:61,column:5}},line:47},"14":{name:"(anonymous_14)",decl:{start:{line:48,column:47},end:{line:48,column:48}},loc:{start:{line:48,column:60},end:{line:60,column:9}},line:48},"15":{name:"(anonymous_15)",decl:{start:{line:62,column:4},end:{line:62,column:5}},loc:{start:{line:62,column:18},end:{line:78,column:5}},line:62},"16":{name:"(anonymous_16)",decl:{start:{line:63,column:47},end:{line:63,column:48}},loc:{start:{line:63,column:60},end:{line:77,column:9}},line:63},"17":{name:"(anonymous_17)",decl:{start:{line:69,column:22},end:{line:69,column:23}},loc:{start:{line:69,column:37},end:{line:76,column:13}},line:69},"18":{name:"(anonymous_18)",decl:{start:{line:79,column:4},end:{line:79,column:5}},loc:{start:{line:79,column:31},end:{line:94,column:5}},line:79},"19":{name:"(anonymous_19)",decl:{start:{line:80,column:47},end:{line:80,column:48}},loc:{start:{line:80,column:60},end:{line:93,column:9}},line:80},"20":{name:"(anonymous_20)",decl:{start:{line:95,column:4},end:{line:95,column:5}},loc:{start:{line:95,column:28},end:{line:103,column:5}},line:95},"21":{name:"(anonymous_21)",decl:{start:{line:96,column:47},end:{line:96,column:48}},loc:{start:{line:96,column:60},end:{line:102,column:9}},line:96},"22":{name:"(anonymous_22)",decl:{start:{line:104,column:4},end:{line:104,column:5}},loc:{start:{line:104,column:20},end:{line:106,column:5}},line:104},"23":{name:"(anonymous_23)",decl:{start:{line:107,column:4},end:{line:107,column:5}},loc:{start:{line:107,column:20},end:{line:117,column:5}},line:107},"24":{name:"(anonymous_24)",decl:{start:{line:110,column:21},end:{line:110,column:22}},loc:{start:{line:110,column:30},end:{line:115,column:9}},line:110},"25":{name:"(anonymous_25)",decl:{start:{line:118,column:4},end:{line:118,column:5}},loc:{start:{line:118,column:28},end:{line:122,column:5}},line:118}},branchMap:{"0":{loc:{start:{line:2,column:17},end:{line:7,column:1}},type:"binary-expr",locations:[{start:{line:2,column:18},end:{line:2,column:22}},{start:{line:2,column:26},end:{line:2,column:41}},{start:{line:2,column:46},end:{line:7,column:1}}],line:2},"1":{loc:{start:{line:3,column:34},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:42},end:{line:3,column:48}},{start:{line:3,column:51},end:{line:3,column:125}}],line:3},"2":{loc:{start:{line:3,column:51},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:67},end:{line:3,column:118}},{start:{line:3,column:121},end:{line:3,column:125}}],line:3},"3":{loc:{start:{line:4,column:4},end:{line:5,column:150}},type:"if",locations:[{start:{line:4,column:4},end:{line:5,column:150}},{start:{line:4,column:4},end:{line:5,column:150}}],line:4},"4":{loc:{start:{line:4,column:8},end:{line:4,column:77}},type:"binary-expr",locations:[{start:{line:4,column:8},end:{line:4,column:35}},{start:{line:4,column:39},end:{line:4,column:77}}],line:4},"5":{loc:{start:{line:5,column:58},end:{line:5,column:150}},type:"if",locations:[{start:{line:5,column:58},end:{line:5,column:150}},{start:{line:5,column:58},end:{line:5,column:150}}],line:5},"6":{loc:{start:{line:5,column:85},end:{line:5,column:149}},type:"binary-expr",locations:[{start:{line:5,column:86},end:{line:5,column:143}},{start:{line:5,column:148},end:{line:5,column:149}}],line:5},"7":{loc:{start:{line:5,column:86},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:94},end:{line:5,column:98}},{start:{line:5,column:101},end:{line:5,column:143}}],line:5},"8":{loc:{start:{line:5,column:101},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:109},end:{line:5,column:126}},{start:{line:5,column:129},end:{line:5,column:143}}],line:5},"9":{loc:{start:{line:6,column:11},end:{line:6,column:62}},type:"binary-expr",locations:[{start:{line:6,column:11},end:{line:6,column:16}},{start:{line:6,column:20},end:{line:6,column:21}},{start:{line:6,column:25},end:{line:6,column:62}}],line:6},"10":{loc:{start:{line:8,column:16},end:{line:16,column:1}},type:"binary-expr",locations:[{start:{line:8,column:17},end:{line:8,column:21}},{start:{line:8,column:25},end:{line:8,column:39}},{start:{line:8,column:44},end:{line:16,column:1}}],line:8},"11":{loc:{start:{line:9,column:35},end:{line:9,column:109}},type:"cond-expr",locations:[{start:{line:9,column:56},end:{line:9,column:61}},{start:{line:9,column:64},end:{line:9,column:109}}],line:9},"12":{loc:{start:{line:10,column:16},end:{line:10,column:34}},type:"binary-expr",locations:[{start:{line:10,column:16},end:{line:10,column:17}},{start:{line:10,column:22},end:{line:10,column:33}}],line:10},"13":{loc:{start:{line:13,column:32},end:{line:13,column:115}},type:"cond-expr",locations:[{start:{line:13,column:46},end:{line:13,column:67}},{start:{line:13,column:70},end:{line:13,column:115}}],line:13},"14":{loc:{start:{line:14,column:51},end:{line:14,column:67}},type:"binary-expr",locations:[{start:{line:14,column:51},end:{line:14,column:61}},{start:{line:14,column:65},end:{line:14,column:67}}],line:14},"15":{loc:{start:{line:32,column:10},end:{line:32,column:40}},type:"default-arg",locations:[{start:{line:32,column:16},end:{line:32,column:40}}],line:32},"16":{loc:{start:{line:33,column:8},end:{line:33,column:152}},type:"cond-expr",locations:[{start:{line:33,column:50},end:{line:33,column:87}},{start:{line:33,column:91},end:{line:33,column:151}}],line:33},"17":{loc:{start:{line:49,column:12},end:{line:59,column:13}},type:"if",locations:[{start:{line:49,column:12},end:{line:59,column:13}},{start:{line:49,column:12},end:{line:59,column:13}}],line:49},"18":{loc:{start:{line:71,column:20},end:{line:73,column:21}},type:"if",locations:[{start:{line:71,column:20},end:{line:73,column:21}},{start:{line:71,column:20},end:{line:73,column:21}}],line:71},"19":{loc:{start:{line:82,column:12},end:{line:92,column:49}},type:"if",locations:[{start:{line:82,column:12},end:{line:92,column:49}},{start:{line:82,column:12},end:{line:92,column:49}}],line:82},"20":{loc:{start:{line:98,column:12},end:{line:101,column:49}},type:"if",locations:[{start:{line:98,column:12},end:{line:101,column:49}},{start:{line:98,column:12},end:{line:101,column:49}}],line:98},"21":{loc:{start:{line:111,column:12},end:{line:113,column:13}},type:"if",locations:[{start:{line:111,column:12},end:{line:113,column:13}},{start:{line:111,column:12},end:{line:113,column:13}}],line:111},"22":{loc:{start:{line:116,column:15},end:{line:116,column:61}},type:"binary-expr",locations:[{start:{line:116,column:15},end:{line:116,column:27}},{start:{line:116,column:31},end:{line:116,column:61}}],line:116},"23":{loc:{start:{line:121,column:15},end:{line:121,column:56}},type:"binary-expr",locations:[{start:{line:121,column:15},end:{line:121,column:33}},{start:{line:121,column:37},end:{line:121,column:56}}],line:121}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},inputSourceMap:{version:3,file:"C:/Users/USER/Documents/GitHub/log2990-108/server/app/services/database.service.ts",sources:["C:/Users/USER/Documents/GitHub/log2990-108/server/app/services/database.service.ts"],names:[],mappings:"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",sourcesContent:["import { DATABASE_COLLECTION, DATABASE_NAME, DATABASE_URL, MAX_TAGS, REGEX_TAG, REGEX_TITLE, STORAGE_DIR } from '@app/constants';\nimport { MetaData } from '@common/communication/metadata';\nimport * as fs from 'fs';\nimport { injectable } from 'inversify';\nimport { Collection, MongoClient, MongoClientOptions } from 'mongodb';\nimport * as multer from 'multer';\nimport 'reflect-metadata';\n\n@injectable()\nexport class DatabaseService {\n    client: MongoClient;\n    collection: Collection<MetaData>;\n    multerObject: multer.Multer;\n    localDrawings: string[];\n\n    private options: MongoClientOptions = {\n        useNewUrlParser: true,\n        useUnifiedTopology: true,\n    };\n\n    start(url = DATABASE_URL) {\n        !fs.existsSync(STORAGE_DIR) ? fs.mkdirSync(STORAGE_DIR) : (this.localDrawings = fs.readdirSync(STORAGE_DIR));\n        MongoClient.connect(url, this.options)\n            .then((client: MongoClient) => {\n                this.client = client;\n                this.collection = client.db(DATABASE_NAME).collection(DATABASE_COLLECTION);\n            })\n            .catch((error: Error) => {\n                throw (error.message = 'Database connection error');\n            });\n    }\n\n    createMulterUpload(directory: string): multer.Multer {\n        this.multerObject = multer({ dest: directory });\n        return this.multerObject;\n    }\n\n    async postDrawing(metaData: MetaData): Promise<void> {\n        if (this.checkMetaData(metaData)) {\n            await this.collection.insertOne(metaData);\n        } else {\n            try {\n                fs.unlinkSync(STORAGE_DIR + metaData.filename);\n            } catch (error) {\n                throw new Error('M\xE9tadonn\xE9es non valides');\n            }\n        }\n    }\n\n    async getMetaData(): Promise<MetaData[]> {\n        this.localDrawings = fs.readdirSync(STORAGE_DIR);\n        const metadatas: MetaData[] = [];\n        return this.collection\n            .find({})\n            .toArray()\n            .then((metaDatas: MetaData[]) => {\n                for (const meta of metaDatas) {\n                    if (this.localDrawings.includes(meta.filename)) {\n                        metadatas.push(meta);\n                    }\n                }\n                return metadatas;\n            });\n    }\n\n    async deleteDrawing(newFilename: string): Promise<void> {\n        this.localDrawings = fs.readdirSync(STORAGE_DIR);\n        if (this.localDrawings.includes(newFilename)) {\n            await this.collection.findOneAndDelete({ filename: newFilename });\n            try {\n                fs.unlinkSync(STORAGE_DIR + newFilename);\n            } catch (error) {\n                throw new Error('Impossible de Supprimer');\n            }\n        } else throw new Error('Dessin Absent');\n    }\n\n    async getDrawing(newFilename: string): Promise<void> {\n        this.localDrawings = fs.readdirSync(STORAGE_DIR);\n        if (this.localDrawings.includes(newFilename)) {\n            \n        } else throw new Error('Dessin Absent');\n    }\n\n    checkName(name: string): boolean {\n        return REGEX_TITLE.test(name);\n    }\n\n    checkTags(tags: string[]): boolean {\n        let validTagList = true;\n        let tagCtr = 0;\n        tags.forEach((tag) => {\n            if (!REGEX_TAG.test(tag)) {\n                validTagList = false;\n            }\n            tagCtr++;\n        });\n        return validTagList && tagCtr <= MAX_TAGS;\n    }\n\n    checkMetaData(metaData: MetaData): boolean {\n        const containsValidTitle = this.checkName(metaData.name);\n        const containsCorrectTags = this.checkTags(metaData.tags);\n        return containsValidTitle && containsCorrectTags;\n    }\n}\n"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b1e971694f35dd3462dd210f76fd6fa6c6085aef"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_ej77p9x2a=function(){return actualCoverage;};}return actualCoverage;}cov_ej77p9x2a();var __decorate=(cov_ej77p9x2a().s[0]++,(cov_ej77p9x2a().b[0][0]++,this)&&(cov_ej77p9x2a().b[0][1]++,this.__decorate)||(cov_ej77p9x2a().b[0][2]++,function(decorators,target,key,desc){cov_ej77p9x2a().f[0]++;var c=(cov_ej77p9x2a().s[1]++,arguments.length),r=(cov_ej77p9x2a().s[2]++,c<3?(cov_ej77p9x2a().b[1][0]++,target):(cov_ej77p9x2a().b[1][1]++,desc===null?(cov_ej77p9x2a().b[2][0]++,desc=Object.getOwnPropertyDescriptor(target,key)):(cov_ej77p9x2a().b[2][1]++,desc))),d;cov_ej77p9x2a().s[3]++;if((cov_ej77p9x2a().b[4][0]++,typeof Reflect==="object")&&(cov_ej77p9x2a().b[4][1]++,typeof Reflect.decorate==="function")){cov_ej77p9x2a().b[3][0]++;cov_ej77p9x2a().s[4]++;r=Reflect.decorate(decorators,target,key,desc);}else{cov_ej77p9x2a().b[3][1]++;cov_ej77p9x2a().s[5]++;for(var i=(cov_ej77p9x2a().s[6]++,decorators.length-1);i>=0;i--){cov_ej77p9x2a().s[7]++;if(d=decorators[i]){cov_ej77p9x2a().b[5][0]++;cov_ej77p9x2a().s[8]++;r=(cov_ej77p9x2a().b[6][0]++,c<3?(cov_ej77p9x2a().b[7][0]++,d(r)):(cov_ej77p9x2a().b[7][1]++,c>3?(cov_ej77p9x2a().b[8][0]++,d(target,key,r)):(cov_ej77p9x2a().b[8][1]++,d(target,key))))||(cov_ej77p9x2a().b[6][1]++,r);}else{cov_ej77p9x2a().b[5][1]++;}}}cov_ej77p9x2a().s[9]++;return(cov_ej77p9x2a().b[9][0]++,c>3)&&(cov_ej77p9x2a().b[9][1]++,r)&&(cov_ej77p9x2a().b[9][2]++,Object.defineProperty(target,key,r)),r;}));var __awaiter=(cov_ej77p9x2a().s[10]++,(cov_ej77p9x2a().b[10][0]++,this)&&(cov_ej77p9x2a().b[10][1]++,this.__awaiter)||(cov_ej77p9x2a().b[10][2]++,function(thisArg,_arguments,P,generator){cov_ej77p9x2a().f[1]++;function adopt(value){cov_ej77p9x2a().f[2]++;cov_ej77p9x2a().s[11]++;return value instanceof P?(cov_ej77p9x2a().b[11][0]++,value):(cov_ej77p9x2a().b[11][1]++,new P(function(resolve){cov_ej77p9x2a().f[3]++;cov_ej77p9x2a().s[12]++;resolve(value);}));}cov_ej77p9x2a().s[13]++;return new((cov_ej77p9x2a().b[12][0]++,P)||(cov_ej77p9x2a().b[12][1]++,P=Promise))(function(resolve,reject){cov_ej77p9x2a().f[4]++;function fulfilled(value){cov_ej77p9x2a().f[5]++;cov_ej77p9x2a().s[14]++;try{cov_ej77p9x2a().s[15]++;step(generator.next(value));}catch(e){cov_ej77p9x2a().s[16]++;reject(e);}}function rejected(value){cov_ej77p9x2a().f[6]++;cov_ej77p9x2a().s[17]++;try{cov_ej77p9x2a().s[18]++;step(generator["throw"](value));}catch(e){cov_ej77p9x2a().s[19]++;reject(e);}}function step(result){cov_ej77p9x2a().f[7]++;cov_ej77p9x2a().s[20]++;result.done?(cov_ej77p9x2a().b[13][0]++,resolve(result.value)):(cov_ej77p9x2a().b[13][1]++,adopt(result.value).then(fulfilled,rejected));}cov_ej77p9x2a().s[21]++;step((generator=generator.apply(thisArg,(cov_ej77p9x2a().b[14][0]++,_arguments)||(cov_ej77p9x2a().b[14][1]++,[]))).next());});}));cov_ej77p9x2a().s[22]++;Object.defineProperty(exports,"__esModule",{value:true});cov_ej77p9x2a().s[23]++;exports.DatabaseService=void 0;const constants_1=(cov_ej77p9x2a().s[24]++,require("@app/constants"));const fs=(cov_ej77p9x2a().s[25]++,require("fs"));const inversify_1=(cov_ej77p9x2a().s[26]++,require("inversify"));const mongodb_1=(cov_ej77p9x2a().s[27]++,require("mongodb"));const multer=(cov_ej77p9x2a().s[28]++,require("multer"));cov_ej77p9x2a().s[29]++;require("reflect-metadata");cov_ej77p9x2a().s[30]++;let DatabaseService=class DatabaseService{constructor(){cov_ej77p9x2a().f[8]++;cov_ej77p9x2a().s[31]++;this.options={useNewUrlParser:true,useUnifiedTopology:true};}start(url=(cov_ej77p9x2a().b[15][0]++,constants_1.DATABASE_URL)){cov_ej77p9x2a().f[9]++;cov_ej77p9x2a().s[32]++;!fs.existsSync(constants_1.STORAGE_DIR)?(cov_ej77p9x2a().b[16][0]++,fs.mkdirSync(constants_1.STORAGE_DIR)):(cov_ej77p9x2a().b[16][1]++,this.localDrawings=fs.readdirSync(constants_1.STORAGE_DIR));cov_ej77p9x2a().s[33]++;mongodb_1.MongoClient.connect(url,this.options).then(client=>{cov_ej77p9x2a().f[10]++;cov_ej77p9x2a().s[34]++;this.client=client;cov_ej77p9x2a().s[35]++;this.collection=client.db(constants_1.DATABASE_NAME).collection(constants_1.DATABASE_COLLECTION);}).catch(error=>{cov_ej77p9x2a().f[11]++;cov_ej77p9x2a().s[36]++;throw error.message='Database connection error';});}createMulterUpload(directory){cov_ej77p9x2a().f[12]++;cov_ej77p9x2a().s[37]++;this.multerObject=multer({dest:directory});cov_ej77p9x2a().s[38]++;return this.multerObject;}postDrawing(metaData){cov_ej77p9x2a().f[13]++;cov_ej77p9x2a().s[39]++;return __awaiter(this,void 0,void 0,function*(){cov_ej77p9x2a().f[14]++;cov_ej77p9x2a().s[40]++;if(this.checkMetaData(metaData)){cov_ej77p9x2a().b[17][0]++;cov_ej77p9x2a().s[41]++;yield this.collection.insertOne(metaData);}else{cov_ej77p9x2a().b[17][1]++;cov_ej77p9x2a().s[42]++;try{cov_ej77p9x2a().s[43]++;fs.unlinkSync(constants_1.STORAGE_DIR+metaData.filename);}catch(error){cov_ej77p9x2a().s[44]++;throw new Error('Métadonnées non valides');}}});}getMetaData(){cov_ej77p9x2a().f[15]++;cov_ej77p9x2a().s[45]++;return __awaiter(this,void 0,void 0,function*(){cov_ej77p9x2a().f[16]++;cov_ej77p9x2a().s[46]++;this.localDrawings=fs.readdirSync(constants_1.STORAGE_DIR);const metadatas=(cov_ej77p9x2a().s[47]++,[]);cov_ej77p9x2a().s[48]++;return this.collection.find({}).toArray().then(metaDatas=>{cov_ej77p9x2a().f[17]++;cov_ej77p9x2a().s[49]++;for(const meta of metaDatas){cov_ej77p9x2a().s[50]++;if(this.localDrawings.includes(meta.filename)){cov_ej77p9x2a().b[18][0]++;cov_ej77p9x2a().s[51]++;metadatas.push(meta);}else{cov_ej77p9x2a().b[18][1]++;}}cov_ej77p9x2a().s[52]++;return metadatas;});});}deleteDrawing(newFilename){cov_ej77p9x2a().f[18]++;cov_ej77p9x2a().s[53]++;return __awaiter(this,void 0,void 0,function*(){cov_ej77p9x2a().f[19]++;cov_ej77p9x2a().s[54]++;this.localDrawings=fs.readdirSync(constants_1.STORAGE_DIR);cov_ej77p9x2a().s[55]++;if(this.localDrawings.includes(newFilename)){cov_ej77p9x2a().b[19][0]++;cov_ej77p9x2a().s[56]++;yield this.collection.findOneAndDelete({filename:newFilename});cov_ej77p9x2a().s[57]++;try{cov_ej77p9x2a().s[58]++;fs.unlinkSync(constants_1.STORAGE_DIR+newFilename);}catch(error){cov_ej77p9x2a().s[59]++;throw new Error('Impossible de Supprimer');}}else{cov_ej77p9x2a().b[19][1]++;cov_ej77p9x2a().s[60]++;throw new Error('Dessin Absent');}});}getDrawing(newFilename){cov_ej77p9x2a().f[20]++;cov_ej77p9x2a().s[61]++;return __awaiter(this,void 0,void 0,function*(){cov_ej77p9x2a().f[21]++;cov_ej77p9x2a().s[62]++;this.localDrawings=fs.readdirSync(constants_1.STORAGE_DIR);cov_ej77p9x2a().s[63]++;if(this.localDrawings.includes(newFilename)){cov_ej77p9x2a().b[20][0]++;}else{cov_ej77p9x2a().b[20][1]++;cov_ej77p9x2a().s[64]++;throw new Error('Dessin Absent');}});}checkName(name){cov_ej77p9x2a().f[22]++;cov_ej77p9x2a().s[65]++;return constants_1.REGEX_TITLE.test(name);}checkTags(tags){cov_ej77p9x2a().f[23]++;let validTagList=(cov_ej77p9x2a().s[66]++,true);let tagCtr=(cov_ej77p9x2a().s[67]++,0);cov_ej77p9x2a().s[68]++;tags.forEach(tag=>{cov_ej77p9x2a().f[24]++;cov_ej77p9x2a().s[69]++;if(!constants_1.REGEX_TAG.test(tag)){cov_ej77p9x2a().b[21][0]++;cov_ej77p9x2a().s[70]++;validTagList=false;}else{cov_ej77p9x2a().b[21][1]++;}cov_ej77p9x2a().s[71]++;tagCtr++;});cov_ej77p9x2a().s[72]++;return(cov_ej77p9x2a().b[22][0]++,validTagList)&&(cov_ej77p9x2a().b[22][1]++,tagCtr<=constants_1.MAX_TAGS);}checkMetaData(metaData){cov_ej77p9x2a().f[25]++;const containsValidTitle=(cov_ej77p9x2a().s[73]++,this.checkName(metaData.name));const containsCorrectTags=(cov_ej77p9x2a().s[74]++,this.checkTags(metaData.tags));cov_ej77p9x2a().s[75]++;return(cov_ej77p9x2a().b[23][0]++,containsValidTitle)&&(cov_ej77p9x2a().b[23][1]++,containsCorrectTags);}};cov_ej77p9x2a().s[76]++;DatabaseService=__decorate([inversify_1.injectable()],DatabaseService);cov_ej77p9x2a().s[77]++;exports.DatabaseService=DatabaseService;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvVVNFUi9Eb2N1bWVudHMvR2l0SHViL2xvZzI5OTAtMTA4L3NlcnZlci9hcHAvc2VydmljZXMvZGF0YWJhc2Uuc2VydmljZS50cyIsInNvdXJjZXMiOlsiQzovVXNlcnMvVVNFUi9Eb2N1bWVudHMvR2l0SHViL2xvZzI5OTAtMTA4L3NlcnZlci9hcHAvc2VydmljZXMvZGF0YWJhc2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw4Q0FBaUk7QUFFakkseUJBQXlCO0FBQ3pCLHlDQUF1QztBQUN2QyxxQ0FBc0U7QUFDdEUsaUNBQWlDO0FBQ2pDLDRCQUEwQjtBQUcxQixJQUFhLGVBQWUsR0FBNUIsTUFBYSxlQUFlO0lBQTVCO1FBTVksWUFBTyxHQUF1QjtZQUNsQyxlQUFlLEVBQUUsSUFBSTtZQUNyQixrQkFBa0IsRUFBRSxJQUFJO1NBQzNCLENBQUM7SUF1Rk4sQ0FBQztJQXJGRyxLQUFLLENBQUMsR0FBRyxHQUFHLHdCQUFZO1FBQ3BCLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyx1QkFBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsdUJBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyx1QkFBVyxDQUFDLENBQUMsQ0FBQztRQUM3RyxxQkFBVyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQzthQUNqQyxJQUFJLENBQUMsQ0FBQyxNQUFtQixFQUFFLEVBQUU7WUFDMUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDLHlCQUFhLENBQUMsQ0FBQyxVQUFVLENBQUMsK0JBQW1CLENBQUMsQ0FBQztRQUMvRSxDQUFDLENBQUM7YUFDRCxLQUFLLENBQUMsQ0FBQyxLQUFZ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akIsSUFBSSxDQUFDLHFCQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUN0QixZQUFZLEdBQUcsS0FBSyxDQUFDO2FBQ3hCO1lBQ0QsTUFBTSxFQUFFLENBQUM7UUFDYixDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sWUFBWSxJQUFJLE1BQU0sSUFBSSxvQkFBUSxDQUFDO0lBQzlDLENBQUM7SUFFRCxhQUFhLENBQUMsUUFBa0I7UUFDNUIsTUFBTSxrQkFBa0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN6RCxNQUFNLG1CQUFtQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzFELE9BQU8sa0JBQWtCLElBQUksbUJBQW1CLENBQUM7SUFDckQsQ0FBQztDQUNKLENBQUE7QUFoR1ksZUFBZTtJQUQzQixzQkFBVSxFQUFFO0dBQ0EsZUFBZSxDQWdHM0I7QUFoR1ksMENBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEQVRBQkFTRV9DT0xMRUNUSU9OLCBEQVRBQkFTRV9OQU1FLCBEQVRBQkFTRV9VUkwsIE1BWF9UQUdTLCBSRUdFWF9UQUcsIFJFR0VYX1RJVExFLCBTVE9SQUdFX0RJUiB9IGZyb20gJ0BhcHAvY29uc3RhbnRzJztcbmltcG9ydCB7IE1ldGFEYXRhIH0gZnJvbSAnQGNvbW1vbi9jb21tdW5pY2F0aW9uL21ldGFkYXRhJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCB7IGluamVjdGFibGUgfSBmcm9tICdpbnZlcnNpZnknO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiwgTW9uZ29DbGllbnQsIE1vbmdvQ2xpZW50T3B0aW9ucyB9IGZyb20gJ21vbmdvZGInO1xuaW1wb3J0ICogYXMgbXVsdGVyIGZyb20gJ211bHRlcic7XG5pbXBvcnQgJ3JlZmxlY3QtbWV0YWRhdGEnO1xuXG5AaW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgRGF0YWJhc2VTZXJ2aWNlIHtcbiAgICBjbGllbnQ6IE1vbmdvQ2xpZW50O1xuICAgIGNvbGxlY3Rpb246IENvbGxlY3Rpb248TWV0YURhdGE+O1xuICAgIG11bHRlck9iamVjdDogbXVsdGVyLk11bHRlcjtcbiAgICBsb2NhbERyYXdpbmdzOiBzdHJpbmdbXTtcblxuICAgIHByaXZhdGUgb3B0aW9uczogTW9uZ29DbGllbnRPcHRpb25zID0ge1xuICAgICAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgc3RhcnQodXJsID0gREFUQUJBU0VfVVJMKSB7XG4gICAgICAgICFmcy5leGlzdHNTeW5jKFNUT1JBR0VfRElSKSA/IGZzLm1rZGlyU3luYyhTVE9SQUdFX0RJUikgOiAodGhpcy5sb2NhbERyYXdpbmdzID0gZnMucmVhZGRpclN5bmMoU1RPUkFHRV9ESVIpKTtcbiAgICAgICAgTW9uZ29DbGllbnQuY29ubmVjdCh1cmwsIHRoaXMub3B0aW9ucylcbiAgICAgICAgICAgIC50aGVuKChjbGllbnQ6IE1vbmdvQ2xpZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gY2xpZW50LmRiKERBVEFCQVNFX05BTUUpLmNvbGxlY3Rpb24oREFUQUJBU0VfQ09MTEVDVElPTik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcjogRXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoZXJyb3IubWVzc2FnZSA9ICdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yJyk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjcmVhdGVNdWx0ZXJVcGxvYWQoZGlyZWN0b3J5OiBzdHJpbmcpOiBtdWx0ZXIuTXVsdGVyIHtcbiAgICAgICAgdGhpcy5tdWx0ZXJPYmplY3QgPSBtdWx0ZXIoeyBkZXN0OiBkaXJlY3RvcnkgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLm11bHRlck9iamVjdDtcbiAgICB9XG5cbiAgICBhc3luYyBwb3N0RHJhd2luZyhtZXRhRGF0YTogTWV0YURhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tNZXRhRGF0YShtZXRhRGF0YSkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29sbGVjdGlvbi5pbnNlcnRPbmUobWV0YURhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmcy51bmxpbmtTeW5jKFNUT1JBR0VfRElSICsgbWV0YURhdGEuZmlsZW5hbWUpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ03DqXRhZG9ubsOpZXMgbm9uIHZhbGlkZXMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGdldE1ldGFEYXRhKCk6IFByb21pc2U8TWV0YURhdGFbXT4ge1xuICAgICAgICB0aGlzLmxvY2FsRHJhd2luZ3MgPSBmcy5yZWFkZGlyU3luYyhTVE9SQUdFX0RJUik7XG4gICAgICAgIGNvbnN0IG1ldGFkYXRhczogTWV0YURhdGFbXSA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCh7fSlcbiAgICAgICAgICAgIC50b0FycmF5KClcbiAgICAgICAgICAgIC50aGVuKChtZXRhRGF0YXM6IE1ldGFEYXRhW10pID0+IHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1ldGEgb2YgbWV0YURhdGFzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvY2FsRHJhd2luZ3MuaW5jbHVkZXMobWV0YS5maWxlbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhcy5wdXNoKG1ldGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YXM7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVEcmF3aW5nKG5ld0ZpbGVuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5sb2NhbERyYXdpbmdzID0gZnMucmVhZGRpclN5bmMoU1RPUkFHRV9ESVIpO1xuICAgICAgICBpZiAodGhpcy5sb2NhbERyYXdpbmdzLmluY2x1ZGVzKG5ld0ZpbGVuYW1lKSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmZpbmRPbmVBbmREZWxldGUoeyBmaWxlbmFtZTogbmV3RmlsZW5hbWUgfSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMoU1RPUkFHRV9ESVIgKyBuZXdGaWxlbmFtZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW1wb3NzaWJsZSBkZSBTdXBwcmltZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHRocm93IG5ldyBFcnJvcignRGVzc2luIEFic2VudCcpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldERyYXdpbmcobmV3RmlsZW5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmxvY2FsRHJhd2luZ3MgPSBmcy5yZWFkZGlyU3luYyhTVE9SQUdFX0RJUik7XG4gICAgICAgIGlmICh0aGlzLmxvY2FsRHJhd2luZ3MuaW5jbHVkZXMobmV3RmlsZW5hbWUpKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIHRocm93IG5ldyBFcnJvcignRGVzc2luIEFic2VudCcpO1xuICAgIH1cblxuICAgIGNoZWNrTmFtZShuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIFJFR0VYX1RJVExFLnRlc3QobmFtZSk7XG4gICAgfVxuXG4gICAgY2hlY2tUYWdzKHRhZ3M6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB2YWxpZFRhZ0xpc3QgPSB0cnVlO1xuICAgICAgICBsZXQgdGFnQ3RyID0gMDtcbiAgICAgICAgdGFncy5mb3JFYWNoKCh0YWcpID0+IHtcbiAgICAgICAgICAgIGlmICghUkVHRVhfVEFHLnRlc3QodGFnKSkge1xuICAgICAgICAgICAgICAgIHZhbGlkVGFnTGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFnQ3RyKys7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdmFsaWRUYWdMaXN0ICYmIHRhZ0N0ciA8PSBNQVhfVEFHUztcbiAgICB9XG5cbiAgICBjaGVja01ldGFEYXRhKG1ldGFEYXRhOiBNZXRhRGF0YSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBjb250YWluc1ZhbGlkVGl0bGUgPSB0aGlzLmNoZWNrTmFtZShtZXRhRGF0YS5uYW1lKTtcbiAgICAgICAgY29uc3QgY29udGFpbnNDb3JyZWN0VGFncyA9IHRoaXMuY2hlY2tUYWdzKG1ldGFEYXRhLnRhZ3MpO1xuICAgICAgICByZXR1cm4gY29udGFpbnNWYWxpZFRpdGxlICYmIGNvbnRhaW5zQ29ycmVjdFRhZ3M7XG4gICAgfVxufVxuIl19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1VzZXJzL1VTRVIvRG9jdW1lbnRzL0dpdEh1Yi9sb2cyOTkwLTEwOC9zZXJ2ZXIvYXBwL3NlcnZpY2VzL2RhdGFiYXNlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs4MEZBQUEsS0FBQSxDQUFBLFdBQUEsMEJBQUEsT0FBQSxDQUFBLGdCQUFBLENBQUEsQ0FBQSxDQUVBLEtBQUEsQ0FBQSxFQUFBLDBCQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxXQUFBLDBCQUFBLE9BQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxTQUFBLDBCQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxDQUNBLEtBQUEsQ0FBQSxNQUFBLDBCQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDLHdCQUNBLE9BQUEsQ0FBQSxrQkFBQSxDQUFBLEMsd0JBR0EsR0FBYSxDQUFBLGVBQWUsQ0FBNUIsS0FBYSxDQUFBLGVBQWUsQ0FBNUIsV0FBQSxFQUFBLGdEQU1ZLEtBQUEsT0FBQSxDQUE4QixDQUNsQyxlQUFlLENBQUUsSUFEaUIsQ0FFbEMsa0JBQWtCLENBQUUsSUFGYyxDQUE5QixDQTBGWCxDQXJGRyxLQUFLLENBQUMsR0FBRyw2QkFBRyxXQUFBLENBQUEsWUFBSCxDQUFKLENBQW1CLGdEQUNwQixDQUFDLEVBQUUsQ0FBQyxVQUFILENBQWMsV0FBQSxDQUFBLFdBQWQsQ0FBRCw2QkFBOEIsRUFBRSxDQUFDLFNBQUgsQ0FBYSxXQUFBLENBQUEsV0FBYixDQUE5Qiw4QkFBMkQsS0FBSyxhQUFMLENBQXFCLEVBQUUsQ0FBQyxXQUFILENBQWUsV0FBQSxDQUFBLFdBQWYsQ0FBaEYsRUFEb0Isd0JBRXBCLFNBQUEsQ0FBQSxXQUFBLENBQVksT0FBWixDQUFvQixHQUFwQixDQUF5QixLQUFLLE9BQTlCLEVBQ0ssSUFETCxDQUNXLE1BQUQsRUFBd0IsaURBQzFCLEtBQUssTUFBTCxDQUFjLE1BQWQsQ0FE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QUMsSUFBRCxDQUFlLHlCQUNwQixHQUFJLENBQUEsWUFBWSwwQkFBRyxJQUFILENBQWhCLENBQ0EsR0FBSSxDQUFBLE1BQU0sMEJBQUcsQ0FBSCxDQUFWLENBRm9CLHdCQUdwQixJQUFJLENBQUMsT0FBTCxDQUFjLEdBQUQsRUFBUSxpREFDakIsR0FBSSxDQUFDLFdBQUEsQ0FBQSxTQUFBLENBQVUsSUFBVixDQUFlLEdBQWYsQ0FBTCxDQUEwQixvREFDdEIsWUFBWSxDQUFHLEtBQWYsQ0FDSCxDQUZELGlDQURpQix3QkFJakIsTUFBTSxHQUNULENBTEQsRUFIb0Isd0JBU3BCLE1BQU8sNEJBQUEsWUFBWSwrQkFBSSxNQUFNLEVBQUksV0FBQSxDQUFBLFFBQWQsQ0FBbkIsQ0FDSCxDQUVELGFBQWEsQ0FBQyxRQUFELENBQW1CLHlCQUM1QixLQUFNLENBQUEsa0JBQWtCLDBCQUFHLEtBQUssU0FBTCxDQUFlLFFBQVEsQ0FBQyxJQUF4QixDQUFILENBQXhCLENBQ0EsS0FBTSxDQUFBLG1CQUFtQiwwQkFBRyxLQUFLLFNBQUwsQ0FBZSxRQUFRLENBQUMsSUFBeEIsQ0FBSCxDQUF6QixDQUY0Qix3QkFHNUIsTUFBTyw0QkFBQSxrQkFBa0IsK0JBQUksbUJBQUosQ0FBekIsQ0FDSCxDQS9GdUIsQ0FBNUIsQyx3QkFBYSxlQUFlLENBQUEsVUFBQSxDQUFBLENBRDNCLFdBQUEsQ0FBQSxVQUFBLEVBQzJCLENBQUEsQ0FBZixlQUFlLENBQWYsQyx3QkFBQSxPQUFBLENBQUEsZUFBQSxDQUFBLGVBQUEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERBVEFCQVNFX0NPTExFQ1RJT04sIERBVEFCQVNFX05BTUUsIERBVEFCQVNFX1VSTCwgTUFYX1RBR1MsIFJFR0VYX1RBRywgUkVHRVhfVElUTEUsIFNUT1JBR0VfRElSIH0gZnJvbSAnQGFwcC9jb25zdGFudHMnO1xuaW1wb3J0IHsgTWV0YURhdGEgfSBmcm9tICdAY29tbW9uL2NvbW11bmljYXRpb24vbWV0YWRhdGEnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHsgaW5qZWN0YWJsZSB9IGZyb20gJ2ludmVyc2lmeSc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uLCBNb25nb0NsaWVudCwgTW9uZ29DbGllbnRPcHRpb25zIH0gZnJvbSAnbW9uZ29kYic7XG5pbXBvcnQgKiBhcyBtdWx0ZXIgZnJvbSAnbXVsdGVyJztcbmltcG9ydCAncmVmbGVjdC1tZXRhZGF0YSc7XG5cbkBpbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBEYXRhYmFzZVNlcnZpY2Uge1xuICAgIGNsaWVudDogTW9uZ29DbGllbnQ7XG4gICAgY29sbGVjdGlvbjogQ29sbGVjdGlvbjxNZXRhRGF0YT47XG4gICAgbXVsdGVyT2JqZWN0OiBtdWx0ZXIuTXVsdGVyO1xuICAgIGxvY2FsRHJhd2luZ3M6IHN0cmluZ1tdO1xuXG4gICAgcHJpdmF0ZSBvcHRpb25zOiBNb25nb0NsaWVudE9wdGlvbnMgPSB7XG4gICAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICAgIH07XG5cbiAgICBzdGFydCh1cmwgPSBEQVRBQkFTRV9VUkwpIHtcbiAgICAgICAgIWZzLmV4aXN0c1N5bmMoU1RPUkFHRV9ESVIpID8gZnMubWtkaXJTeW5jKFNUT1JBR0VfRElSKSA6ICh0aGlzLmxvY2FsRHJhd2luZ3MgPSBmcy5yZWFkZGlyU3luYyhTVE9SQUdFX0RJUikpO1xuICAgICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybCwgdGhpcy5vcHRpb25zKVxuICAgICAgICAgICAgLnRoZW4oKGNsaWVudDogTW9uZ29DbGllbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjbGllbnQuZGIoREFUQUJBU0VfTkFNRSkuY29sbGVjdGlvbihEQVRBQkFTRV9DT0xMRUNUSU9OKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycm9yOiBFcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IChlcnJvci5tZXNzYWdlID0gJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3InKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNyZWF0ZU11bHRlclVwbG9hZChkaXJlY3Rvcnk6IHN0cmluZyk6IG11bHRlci5NdWx0ZXIge1xuICAgICAgICB0aGlzLm11bHRlck9iamVjdCA9IG11bHRlcih7IGRlc3Q6IGRpcmVjdG9yeSB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubXVsdGVyT2JqZWN0O1xuICAgIH1cblxuICAgIGFzeW5jIHBvc3REcmF3aW5nKG1ldGFEYXRhOiBNZXRhRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5jaGVja01ldGFEYXRhKG1ldGFEYXRhKSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmluc2VydE9uZShtZXRhRGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZzLnVubGlua1N5bmMoU1RPUkFHRV9ESVIgKyBtZXRhRGF0YS5maWxlbmFtZSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTcOpdGFkb25uw6llcyBub24gdmFsaWRlcycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0TWV0YURhdGEoKTogUHJvbWlzZTxNZXRhRGF0YVtdPiB7XG4gICAgICAgIHRoaXMubG9jYWxEcmF3aW5ncyA9IGZzLnJlYWRkaXJTeW5jKFNUT1JBR0VfRElSKTtcbiAgICAgICAgY29uc3QgbWV0YWRhdGFzOiBNZXRhRGF0YVtdID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmNvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKHt9KVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLnRoZW4oKG1ldGFEYXRhczogTWV0YURhdGFbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbWV0YSBvZiBtZXRhRGF0YXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxEcmF3aW5ncy5pbmNsdWRlcyhtZXRhLmZpbGVuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFzLnB1c2gobWV0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhcztcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFzeW5jIGRlbGV0ZURyYXdpbmcobmV3RmlsZW5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmxvY2FsRHJhd2luZ3MgPSBmcy5yZWFkZGlyU3luYyhTVE9SQUdFX0RJUik7XG4gICAgICAgIGlmICh0aGlzLmxvY2FsRHJhd2luZ3MuaW5jbHVkZXMobmV3RmlsZW5hbWUpKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNvbGxlY3Rpb24uZmluZE9uZUFuZERlbGV0ZSh7IGZpbGVuYW1lOiBuZXdGaWxlbmFtZSB9KTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZnMudW5saW5rU3luYyhTVE9SQUdFX0RJUiArIG5ld0ZpbGVuYW1lKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIGRlIFN1cHByaW1lcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgdGhyb3cgbmV3IEVycm9yKCdEZXNzaW4gQWJzZW50Jyk7XG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0RHJhd2luZyhuZXdGaWxlbmFtZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMubG9jYWxEcmF3aW5ncyA9IGZzLnJlYWRkaXJTeW5jKFNUT1JBR0VfRElSKTtcbiAgICAgICAgaWYgKHRoaXMubG9jYWxEcmF3aW5ncy5pbmNsdWRlcyhuZXdGaWxlbmFtZSkpIHtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2UgdGhyb3cgbmV3IEVycm9yKCdEZXNzaW4gQWJzZW50Jyk7XG4gICAgfVxuXG4gICAgY2hlY2tOYW1lKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gUkVHRVhfVElUTEUudGVzdChuYW1lKTtcbiAgICB9XG5cbiAgICBjaGVja1RhZ3ModGFnczogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHZhbGlkVGFnTGlzdCA9IHRydWU7XG4gICAgICAgIGxldCB0YWdDdHIgPSAwO1xuICAgICAgICB0YWdzLmZvckVhY2goKHRhZykgPT4ge1xuICAgICAgICAgICAgaWYgKCFSRUdFWF9UQUcudGVzdCh0YWcpKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRUYWdMaXN0ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YWdDdHIrKztcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB2YWxpZFRhZ0xpc3QgJiYgdGFnQ3RyIDw9IE1BWF9UQUdTO1xuICAgIH1cblxuICAgIGNoZWNrTWV0YURhdGEobWV0YURhdGE6IE1ldGFEYXRhKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5zVmFsaWRUaXRsZSA9IHRoaXMuY2hlY2tOYW1lKG1ldGFEYXRhLm5hbWUpO1xuICAgICAgICBjb25zdCBjb250YWluc0NvcnJlY3RUYWdzID0gdGhpcy5jaGVja1RhZ3MobWV0YURhdGEudGFncyk7XG4gICAgICAgIHJldHVybiBjb250YWluc1ZhbGlkVGl0bGUgJiYgY29udGFpbnNDb3JyZWN0VGFncztcbiAgICB9XG59XG4iXX0=